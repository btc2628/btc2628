CREATE TABLE #DateDimension (
    DateKey INT NOT NULL PRIMARY KEY,
    DateValue DATE NOT NULL,
    DateFullName NVARCHAR(20) NOT NULL,
    Year INT NOT NULL,
    Quarter INT NOT NULL,
    Month INT NOT NULL,
    MonthName NVARCHAR(15) NOT NULL,
    Day INT NOT NULL,
    DayOfWeek NVARCHAR(15) NOT NULL,
    WeekOfYear INT NOT NULL,
    IsWeekend BIT NOT NULL
);

DECLARE @StartDate DATE = '2015-01-01';
DECLARE @EndDate DATE = '2100-12-31';

WHILE @StartDate <= @EndDate
BEGIN
    INSERT INTO #DateDimension (
        DateKey,
        DateValue,
        DateFullName,
        Year,
        Quarter,
        Month,
        MonthName,
        Day,
        DayOfWeek,
        WeekOfYear,
        IsWeekend
    )
    VALUES (
        CAST(CONVERT(VARCHAR(8), @StartDate, 112) AS INT),
        @StartDate,
        CAST(DAY(@StartDate) AS NVARCHAR(2)) + ' ' + DATENAME(MONTH, @StartDate) + ' ' + CAST(YEAR(@StartDate) AS NVARCHAR(4)),
        YEAR(@StartDate),
        DATEPART(QUARTER, @StartDate),
        MONTH(@StartDate),
        DATENAME(MONTH, @StartDate),
        DAY(@StartDate),
        DATENAME(WEEKDAY, @StartDate),
        DATEPART(wk, @StartDate),
        CASE WHEN DATEPART(dw, @StartDate) IN (1, 7) THEN 1 ELSE 0 END
    );

    SET @StartDate = DATEADD(DAY, 1, @StartDate);
END;
