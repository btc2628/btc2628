WITH RankedData AS (
    SELECT 
        Name,
        id,
        number,
        Month,
        ROW_NUMBER() OVER (PARTITION BY Name, id, number ORDER BY Month) as row_num
    FROM 
        original_table
),
GroupedData AS (
    SELECT 
        Name,
        id,
        number,
        Month,
        Month - row_num as group_num
    FROM 
        RankedData
)
SELECT
    Name,
    id,
    number,
    MIN(Month) as startMonth,
    MAX(Month) as endMonth
FROM 
    GroupedData
GROUP BY
    Name,
    id,
    number,
    group_num
ORDER BY
    Name,
    id,
    number,
    startMonth;
