WITH 
DateConverted AS (
    SELECT 
        Name,
        id,
        number,
        EXTRACT(YEAR FROM Month) * 100 + EXTRACT(MONTH FROM Month) AS YearMonth
    FROM 
        original_table
),
RankedData AS (
    SELECT 
        Name,
        id,
        number,
        YearMonth,
        ROW_NUMBER() OVER (PARTITION BY Name, id, number ORDER BY YearMonth) as row_num
    FROM 
        DateConverted
),
GroupedData AS (
    SELECT 
        Name,
        id,
        number,
        YearMonth,
        YearMonth - row_num as group_num
    FROM 
        RankedData
)
SELECT
    Name,
    id,
    number,
    MIN(YearMonth) as startMonth,
    MAX(YearMonth) as endMonth
FROM 
    GroupedData
GROUP BY
    Name,
    id,
    number,
    group_num
ORDER BY
    Name,
    id,
    number,
    startMonth;
